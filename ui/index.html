<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
		<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
		<script crossorigin src="https://unpkg.com/react-router-dom@4.3.1/umd/react-router-dom.min.js"></script>

		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
		
		<style>
			.view .heading {
				height: 76px;
				font-size:36px;
			}

			.view .heading-title {
				height: 76px;
				text-height: 76px;
			}

			.view .body {
				height: 616px;
			}
			
			.view .footer {
				height: 76px;
			}

			.view .menu {
				width: 76px;
				height: 76px;
			}
		</style>
		
		<!-- Don't use this in production: -->
		<script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
		
		<script type="text/babel">

			function getLocale() {
				return 'fi-FI';
			}

			function Heading(props) {
				return (
					<div className={"heading w3-display-container w3-center"}>
						<div className={"menu w3-display-topleft w3-yellow"}><a>X</a></div>
						<div className={"heading-title w3-display-top w3-green w3-wide"}><a>TuPLa</a></div>
						<div className={"menu w3-display-topright w3-yellow"}><a>Y</a></div>
					</div>
				);
/*				return (
					<div className={"heading w3-display-container"}>
						<a className={"menuitem w3-display-topleft w3-yellow"}>X</a>
						<h1 className={"w3-green w3-center w3-wide"}>TuPaL</h1>
						<a className={"menuitem w3-display-toprigth w3-yellow"}>Y</a>
					</div>
				);
*/
			}

			function Footer(props) {
				return (
					<div className={"footer w3-container w3-green"}>
						<Clock/>
					</div>
				);
			}

			function CompetitorListView(props) {
				return (
					<div class="view">
						<Heading/>
						<div className={"body w3-padding w3-container w3-blue"}>
							Teksti√§, juu...
						</div>
						<Footer/>
					</div>
				)
			}

			function CompetitorView(props) {
				const tags = [
					{ id: 'MYL' }, { id: 'NYL' }, { id: 'W40' }
				];
				const tagged = [ 'NYL' ];

				return (
					<div class="view">
						<Heading/>
						<div className={"body w3-padding w3-container w3-blue"}>
							<div className={"w3-row"}>
								<div className={"w3-padding w3-col m3 l3"}>
									<label>Given name</label>
									<input className={"w3-input"} type="text"></input>
								</div>

								<div className={"w3-padding w3-col m3 l3"}>
									<label>Family name</label>
									<input className={"w3-input"} type="text"></input>
								</div>

								<div className={"w3-padding w3-col m3 l3"}>
									<label>Community</label>
									<input className={"w3-input"} type="text"></input>
								</div>

								<div className={"w3-padding w3-col m1 l2"}>
									<label>BIB number</label>
									<input className={"w3-input"} type="text"></input>
								</div>

								<div className={"w3-padding w3-col m12 l12"}>
									<label>Tags</label>
									<Tags tags={tags} tagged={tagged}/>
								</div>
							</div>
						</div>
						<Footer/>
					</div>
				);
			}

			class Tags extends React.Component {
				constructor(props) {
					super(props);
					this.state = { tagged: props.tagged }
				}

				onTagToggle(id) {
					this.setState(function(state) {
						var clone = state.tagged.slice(0);

						if (clone.includes(id))
							clone.splice(clone.indexOf(id), 1);
						else
							clone.push(id);

						return {
							tagged : clone
						};
					});
				}

				render() {
					const buttons = this.props.tags.map((tag) =>
						<button className={'w3-button w3-round-large w3-border '
										+ (this.state.tagged.includes(tag.id) ? 'w3-white' : 'w3-yellow')}
								onClick={(e) => this.onTagToggle(tag.id)}>
							{tag.id}
						</button>
					);

					return (<div>{buttons}</div>);
				}
			}
			
			class Clock extends React.Component {
				constructor(props) {
					super(props);
					this.state = { date: new Date() };
				}
				
				componentDidMount() {
					this.timerId = setInterval(() => this.tick(), 1000);
				}
				
				componentWillUnmount() {
					clearInterval(this.timerId);
				}
				
				tick() {
					this.setState( { date: new Date() } );
				}
				
				render() {
					return (
						<div>
							<h1>{this.state.date.toLocaleTimeString(getLocale())}</h1>
						</div>
					);
				}
			}
			
			ReactDOM.render(
				<CompetitorView/>,
				document.getElementById('root')
			);
		</script>
	</head>
	
	<body>
		<div id="root"></div>
	</body>
</html>